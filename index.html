<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>幸福教養概念館</title>
    <style>
        :root { --primary-color: #f4f1ea; --accent-color: #8d775f; --text-color: #4a4a4a; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--primary-color); color: var(--text-color); margin: 0; padding: 20px; }
        header { text-align: center; padding: 40px 0; border-bottom: 1px solid #ddd; }
        .museum-section { max-width: 800px; margin: 40px auto; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .card h3 { color: var(--accent-color); margin-top: 0; }
        .tag { font-size: 0.8em; background: #e0dcd0; padding: 2px 8px; border-radius: 4px; margin-right: 5px; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; margin-bottom: 15px; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 8px; }
        .content { line-height: 1.6; white-space: pre-wrap; }
    </style>
</head>
<body>

<header>
    <h1>幸福教養概念館</h1>
    <p>—— 笑長的數位策展空間 ——</p>
    <p style="font-size: 0.9em; color: #888;">(只要改試算表，這裡就會自動更新)</p>
</header>

<div id="museum-content" class="museum-section">
    <p style="text-align: center;">正在從倉庫提貨中...</p>
</div>

<script>
    // 這是您的專屬倉庫連線網址
    const API_URL = "https://script.google.com/macros/s/AKfycbzeuQFds9g_H5_Wa7CIYSQs5k2KHBdDG45zPNNJF74xPfYU9NkSYXLBSKDZzcCWjaF3OA/exec";

    async function loadMuseum() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();
            const container = document.getElementById('museum-content');
            container.innerHTML = ""; 

            if (data.length === 0) {
                container.innerHTML = "<p style='text-align:center;'>倉庫目前是空的，請在試算表填入資料並設為「已上架」。</p>";
                return;
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                
                let videoHTML = "";
                if (item["影音連結"] && item["影音連結"].includes("youtube.com")) {
                    // 簡單處理 YouTube 網址轉換
                    const videoId = item["影音連結"].split('v=')[1]?.split('&')[0];
                    if (videoId) {
                        videoHTML = `<div class="video-container"><iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe></div>`;
                    }
                }

                card.innerHTML = `
                    <span class="tag">${item["展示廳"]}展廳</span>
                    <span class="tag">理念：${item["核心理念"]}</span>
                    <h3>${item["標題"]}</h3>
                    ${videoHTML}
                    <div class="content">${item["感悟內文"]}</div>
                    <p style="font-size: 0.7em; color: #bbb; margin-top: 15px;">發布日期：${item["發布日期"]}</p>
                `;
                container.appendChild(card);
            });
        } catch (error) {
            console.error(error);
            document.getElementById('museum-content').innerHTML = "<p style='text-align:center;'>連線成功，但倉庫裡還沒有「已上架」的內容喔！</p>";
        }
    }
    loadMuseum();
</script>

</body>
</html>
